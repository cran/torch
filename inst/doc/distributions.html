<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Distributions</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Distributions</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(torch)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">torch_manual_seed</span>(<span class="dv">1</span>) <span class="co"># setting seed for reproducibility</span></span></code></pre></div>
<p>This vignette showcases the basic functionality of distributions in torch. Currently the distributions modules are considered ‘work in progress’ and are still experimental features in the torch package. You can see the progress in this <a href="https://github.com/mlverse/torch/issues/479">link</a>.</p>
<p>The distributions modules in torch are modelled after PyTorch’s <a href="https://pytorch.org/docs/stable/distributions.html#">distributions module</a> which in turn is based on the TensorFlow <a href="https://arxiv.org/abs/1711.10604">Distributions package</a>.</p>
<p>This vignette is based in the TensorFlow’s distributions <a href="https://www.tensorflow.org/probability/examples/TensorFlow_Distributions_Tutorial#basic_univariate_distributions">tutorial</a>.</p>
<div id="basic-univariate-distributions" class="section level2">
<h2>Basic univariate distributions</h2>
<p>Let’s start and create a new instance of a normal distribution:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">distr_normal</span>(<span class="at">loc =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; torch_Normal ()</span></span></code></pre></div>
<p>We can draw samples from it with:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>n<span class="sc">$</span><span class="fu">sample</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; torch_tensor</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.8007</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [ CPUFloatType{1} ]</span></span></code></pre></div>
<p>or, draw multiple samples:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>n<span class="sc">$</span><span class="fu">sample</span>(<span class="dv">3</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; torch_tensor</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -1.0235</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -1.4508</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.8554</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [ CPUFloatType{3,1} ]</span></span></code></pre></div>
<p>We can evaluate the log probability of values:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>n<span class="sc">$</span><span class="fu">log_prob</span>(<span class="dv">0</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; torch_tensor</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.9189</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [ CPUFloatType{1} ]</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fu">dnorm</span>(<span class="dv">0</span>)) <span class="co"># equivalent R code</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.9189385</span></span></code></pre></div>
<p>or, evaluate multiple log probabilities:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>n<span class="sc">$</span><span class="fu">log_prob</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; torch_tensor</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.9189</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2.9189</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -8.9189</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [ CPUFloatType{3} ]</span></span></code></pre></div>
</div>
<div id="multiple-distributions" class="section level2">
<h2>Multiple distributions</h2>
<p>A distribution can take a tensor as it’s parameters:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">distr_bernoulli</span>(<span class="at">probs =</span> <span class="fu">torch_tensor</span>(<span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>b</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; torch_Bernoulli ()</span></span></code></pre></div>
<p>This object represents 3 independent Bernoulli distributions, one for each element of the tensor.</p>
<p>We can sample a single observation:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>b<span class="sc">$</span><span class="fu">sample</span>()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; torch_tensor</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [ CPUFloatType{3} ]</span></span></code></pre></div>
<p>or, a batch of <code>n</code> observations:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>b<span class="sc">$</span><span class="fu">sample</span>(<span class="dv">6</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; torch_tensor</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0  1  1</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0  0  0</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  0  0</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  0  1</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  0  1</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  1  0</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [ CPUFloatType{6,3} ]</span></span></code></pre></div>
</div>
<div id="using-distributions-within-models" class="section level2">
<h2>Using distributions within models</h2>
<p>The <code>log_prob</code> method of distributions can be differentiated, thus, distributions can be used to train models in torch.</p>
<p>Let’s implement a Gaussian linear model, but first let’s simulate some data</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">torch_randn</span>(<span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>x <span class="sc">+</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">torch_randn</span>(<span class="dv">100</span>, <span class="dv">1</span>)</span></code></pre></div>
<p>and plot:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.numeric</span>(x), <span class="fu">as.numeric</span>(y))</span></code></pre></div>
<p><img src="data:image/png;base64,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r7Pm8d15553hkEMOqbr/888/75aHtdZaq+q+2kEIVEOApdcee+wRpphiivDcc8+Fueee250MUTZj1cq+7HjeML2j80EyGnfccat137HbB2VATz31VNh///3DjTfe6D4JODrNNNNMDsZtt93mnsBw3+233z4g+k077bQde6G1Duz73/9+4K8a4V0KHiIh0CwEjjjiCGdAK620kjMVdDpYwf7+979X9GbG6tXtVFEJ/dZbb7kot/HGG4clllgiPPHEE+Gf//xn+Otf/xpgPA8++KAzoTfeeCNgOsRECMc+7rjj+vgsdDs4Gr8QaDcCe+65py+t8Ot59dVXw9133x1YbRSVKkpAI0eODKxJcYpKbt2VAMDxiT+cpViaHX/88eGqq64KW2yxRaXd1SYECodACoXARJ7+hnqRLKl6RbquyIDwPaiXUI6df/759R6m/YVA1yJw5ZVXhiOPPNJ1NgR+Eg5x8cUXB/x3RLUhUHEJlj30nnvuCXvvvbcrobPt+i4EehkBosw32WQTVzugnnj55ZfDSy+9FGBEH3zwQS9DU9e1V2VAk002Wbj55pvDIoss4n8nn3xywGtTJAR6FQGUwzgNYhlG/YAhBtM5v7feeutw6KGH9io0dV93VQaEFh79DornFVdc0a1d6H2wFKHvwRQoEgKdgMCXX34ZcNTDeML8POmkk9xruFljY67T5+qrrx54MV966aXufZztH18cTOSi2hCoyoBSN1jDSMKFSZC177e//W03v+O/sNdee/k6OO2rTyHQbgTIicMcvfbaa8OWW27pc3PUqFGuj6kUN1Xv+FA2k97i8ssvD+uss45/f+CBB5wRvf3226Xu0P9ko9dLGzJf8HpmvKIQamZACSy8Lx999NGACzjOUXhgEn2LElqiZ0JJn+1GgKUPIQqjR48OP/jBD1wCQi+DtLLddtuVQhkaHRfxWHi//+Uvf/F8POTlQQL62c9+5kGkX3/9tXdNjNZyyy3X7zQwnX333detxgSTzjHHHOGXv/xlv/16rsE4e1UynU800TZa8i2yJ0ZLDxANzGiOiqVjL7vsMt/28MMPl9qK/GXiiSeOFvhX5Evsmmuzhz9aBHg03Uy/MduyLJrTaDQpqN+2ehpM0o+vvPJK6RDzlvf5ThvbjNlFsx57m0lEpf34YtJONOksmurC++C36Yt8X56jVtFCCy0ULX1H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E46olMbuBYfTwpjhWz0p1L8QEALNR0AMqPmYqkchIARqREAMqEagtJsQEALNR0AMqPmYqkchIARqREAMqEagtJsQEALNR0AMqPmYqkchIARqREAMqEagtJsQEALNR0AMqPmYqkchIARqRECOiDUC1czdiG4nXKNdntDkmJ5jjjmaeQkD9oUTHalE2uEJTYluwlna4QlNOAtVd1tZiCCBSigGTo9kIC06iQEV/Q7r+oRAByOgJVgH3xwNTQgUHQExoKLfYV2fEOhgBMSAOvjmaGhCoOgIiAEV/Q7r+oRAByMgBtTBN0dDEwJFR0AMqOh3WNcnBDoYATGgDr45GpoQKDoCYkBFv8O6PiHQwQiIAXXwzdHQhEDRERADKvod1vUJgQ5GQAwo55tT5KpIJN6nkkSrqN3YcS1cUzvom2++acdpcj+HGFAOt4CgRqorUHp54oknDiuttFKgVliRiAeIqhU777xz0y/r0UcfDVtttVWYfPLJvdzQUUcd1fRzlHf48ssvewXcm266qXxT034/88wzYd111/VacxNOOGFYYoklAiWcikxiQDncXaqmUpJn++23D7fddluYYYYZwqqrrhqeffbZHEbT/FMSzb3rrruGG2+8semdU+eMgpDQnXfeGYYPHx6OO+640Eom9Le//c2ZKbXBWkUffvhhWGONNcJ7770XmB/XX3+9MzwY0sMPP9yq0+bfr4mxojYiYA9QnHbaaeP+++9fOuunn34arbpnHDFiRKmtW7889NBDcd55542TTTZZnHrqqeN2223X1Es57LDDolWjjV988UWpX6uzFq1iabSCfqW2Zn057bTT/N7MPffcVBCOxhia1XWffs4991zv/4EHHii1My9MQo577LFHqa1oXyQBtfkdQOG+J554IhxyyCGlM1PID6lh3HHHLbV165dzzjnHJbpHHnmkJdVYR48eHdZee+0+hQ832GADLz/94IMPNh22Y445JhgDCDfccEPT+852uOiii4bTTz89LLnkkqVm8hxRCpoyzUWlsYt6YZ18XVNNNZUPD4Umuh8mOYm10tKik8debWyHH354SxOtvfjii2HZZZftMwyWsBAlqJtNLH9IHPfGG280u+s+/cGA+MsSVW1Jurbvvvtmmwv1XQwox9s5cuTIcMABB/gIqDM/22yz5Tia5py61VkebVni9eCzo7Xlnv8k02SzqdXXM9B4P//887D77ruHueaaK+y4444D7db17WJALbyFKBS//vrr0hkQqbF6Jdpss83CaqutFi688EK3FvEGTwwp7dOJn1wT15YlpLqxx279dOIcY401VvbUnv6VFLAsY4tAn332WWBZ+dJLL7mifbzxxivCZVW8BumAKsLSnEYsW9NPP33p76STTurT8ayzzhoWX3zxcPLJJ7teY9SoUX22d+oPlkHZ6+L7Cy+80JbhmgI/oDPLEjoSU866+Trb3o3fP/nkk7D66qsHXA1uvvnmsNhii3XjZdQ85ta/smoeSvF2PPjgg0PWdLvUUksF3m4oS/HxyCZTR7F67bXXhtdffz3MNNNMHQ0Gy5JTTz21zxhhDO0gksK/8847fU6Vfnf7Epbl5ZprrukJ6e+4446wyCKL9LnOIv4QA2rhXd1iiy369Y6zGZLRiSeeGPbZZ5/Sdt52448/vksWpcYO/YIDIPqJPGiVVVYJWNpwdBxzzP8K8PgbmRuDS5N5jKkZ50SCW3/99V3Zfc8997jupxn9dnofWoK1+Q7NN998YbnllvNl16233urmY5gRZt699967n36jzcPr+NPh4EiJHHRlSJP33XdfOOGEE9yxc9JJJ+348Q80QIwQMJ5NNtnEJeSLLroopD8cLgtLRXNs6obrefPNN6MtudzxzJSn0fx/4rBhw6LFGnXD8Gseo4WaNN0RkZNfc8010dwWIthNMcUU0cI9oinGax5XIzva0riljojLL7+892+Mpt/nWmut1ciQu+IY1QXL8dWC+z3WpNlnnz2MM844OY6k+05tT5f7yKAva4f1rfsQ6o4RiwF1x33SKIVAIRGQDqiQt1UXJQS6AwExoO64TxqlECgkAmJAhbytuigh0B0IiAF1x33SKIVAIREQAyrkbdVFCYHuQEAMqDvuk0YpBAqJgBhQIW+rLkoIdAcCYkDdcZ80SiFQSATEgAp5W3VRQqA7EBAD6o77pFEKgUIiIAZUyNuqixIC3YGAGFB33CeNUggUEgExoELeVl2UEOgOBMSAuuM+aZRCoJAIiAEV8rbqooRAdyAgBtQd90mjFAKFREAMqJC3VRclBLoDATGg7rhPGqUQKCQCYkCFvK26KCHQHQiIAXXHfdIohUAhERADKuRt1UUJge5AQAyoO+6TRikEComAGFAhb6suSgh0BwJiQN1xnzRKIVBIBMSACnlbdVGNIvDGG2+Ejz/+uKbDn3nmmUCFVlHjCIgBNY6djuxgBKxefFh88cXrGuFnn30WVl111fDVV1/VdNyIESPCZZddVtO+2qkyAmNXblarEOhuBJZbbrkwwwwz1HURI0eODNtuu22Yeuqpazru2GOPDWuvvXbYeOONwzjjjFPTMdqpLwKqDd8XD/3qUQTeeeedMO+884YXX3wxTDHFFDWjsOmmm4YVV1wx/PSnP635GO34PwS0BPsfFoX49vLLL4dNNtkkzDrrrGGSSSbxZchFF11UurZPP/007LDDDmHaaaf1B22VVVYJ999/f2l7pS8rrbRSGD16tD9kM800U+Bv3333Df/+979997vuuissscQS4YMPPuhz+FJLLRUuv/xyb7vvvvvC0ksvHdCbrLHGGn7uNddcMzDeRx55JKy88so+Jh7kN998s08/5513XlhsscX8eujzuuuu67N9+eWXD9dee21YZpllwpxzzhluvPHGcPTRR4dtttmmtB/Lqz333NOZzFxzzRUOOuigPudhOcU5EvO5+uqr/Zq47kR/+ctfvO2aa65JTWGjjTYKRx11VKB/UQMImBJNVBAEPvnkkzj55JPHZZddNp577rnxzDPPjPbQoyWNTz31lF+lLTGiMZB46qmnxksuuSTagx/HG2+8+P777w+Iwre+9a0444wzer+nn3563GmnnbzPE044wY+xh9V/v/XWW336GHPMMeNpp53mbTfddFPkN/3Ywx9/8YtfxKmmmioussgi0Zhl3GuvveKvfvWrOPHEE8dhw4aV+jnxxBPjWGONFTfffPN4xRVXxJ/97GdxjDHGiFdeeWVpnwknnDDacivasiuuu+668dFHH/UxGkPxff7zn//E733ve35uY2bxnHPOicao4oYbbljqY7bZZosnnXRS6ffXX38dl1xyyTjHHHPEL774wv/mnntuPwf9Jfroo4/82u+4447UpM86EECLLyoIAjfccIM/zK+88krpiv7617/6A3LWWWd52yyzzOIMIO1g0kaEKSUGldqznzAgU+jGb775ptT83e9+N66++ur+u1YGBCM88sgjS33sv//+PjbTpZTafv7zn8eFFlrIf5s1Kk466aRxu+22K23niy17okkxpTYYEIwsyxhgkokBXXXVVX6ehx9+uHTMbbfdFieaaKL43HPPOXOBOXIdWXryySfjuOOOG4844ojIWNnflmjZXfy7SU0RxiyqHwEpoRuQGjv1kHXWWceXNIzvyy+/DM8//3xg6WMPV/jnP//pw8YyZG96/20SQGD5csEFF1S9JJZqJnmU9mMZY8yt9LvWL+hLEi244IL+1aSW1OSK4xdeeMF/P/bYY8GkumCSSDDmUdpnvvnm86WdSW1hyimn9PYVVljBr7O0U+bL448/HmaffXZfYqVmrF3/+Mc//JqeeOKJYMy1n9J6gQUWCAcffHA47rjj3DJmUmMwiSh1UfpE2W2MrPRbX2pHQDqg2rHqij1t2RV4cGwpE9CXXHjhhe6rYu8mH78tPwIP/KhRowJMBV3Q8OHD/QEc7AJtudRn8/jjj1/1mD4H/P+PrGXKllbeir4qUWrjt0ly3rzHHnu47gU9E38mkXh72s4P9FID0bPPPhumm266fpsTQ00MDyzKae+993b8wHP77bcv3+y/OQ7ltah+BMSA6sesY4+A2ey6665ulbn55puD6SfCLbfc4uNNDMh0RMF0KeHdd9915oRi2JZF4ZRTThn0utLDWmmntC0ppdkHyQWpopzGHrt2oZuxQvfcc0/4/PPP+/2hNE40WL+2jPPxpH3T53vvvefMxZZw3vT222+nTaVPlNOY2G1554y6tCHzheMmmGCCTIu+1oqAGFCtSHXBflhu5p9//mD6iLDaaqsFHizTY/hDxgPEsmzLLbcMWHGw9my99dZuUWJ58uCDDzZ8haYb8WOzVjCkjqESZnEICxfXkv5w/oPRZhneYOeaZ555XELJjg+pZ5pppgkw6iT5sGTNEstXfIPw94FJ8522LMHYkX5SH9lt+l4dATGg6hh1zR4436GX4SFB+kCHkkzR6IBYNpnFK5iVKWBSxnQMM2Ipgy4Iwiy+4447hnvvvbfm62bJh5Rw+OGHe18PPPBAwBN5qM556Jnws8EMD1NNEp1ZwoJZ0/xaahnkj370owCTNEuaX/dLL70UDjjgAF/O4UgI02aJldVpwaxxVzBle9htt90C50Tioo1tiV5//fVgVjJ3AUht+qwDgfr11jqiUxH48MMP4/e///1oywE3rdtbOZ5//vnR/G3ieuut58N+9dVXo3nuxskmm8wtQyZVuIUnWZDMJ8jbMVUnwgp2/PHHp5/+aUwqmj6m1IbJHyuRTb1o/kfx7LPPjiZ59DHDs80YXOkY80/y/XEfSHTyySf7+NNvzNxY6WyJ5fuaLsdN7MZQ0y6Ra8ia0NmQtYLx25hiNEbjfTAOrGi0JQI3/hLts88+bgF7+umnU1M0ZbaPg22JzCfJ3QsGc2NI++qzPwLyhK6DWXfLrkg7xoxcShhozCzJXnvttWBm+QGtRwMdO1B76nPmmWcOWWXyQPvX0058Fg6KKKyTzqme49O+6H2QYJCgsv0g8WEZQzoaTKGd+kmfxth9+WV+V6lJn3UgIAZUB1jatdgIsETDSoebQi1kvlOBZS+6I+mAakGs/z5iQP0xUUuPImDLU/c5gqEkC9xgUJiDpId2HHjggYPtpm2DIFC7TXSQTrRJCBQBAZajl156aSBerhYGhOMnsWCixhGQBNQ4djpSCAiBISIgM/wQAdThQkAINI6AGFDj2OlIISAEhoiAGNAQAdThQkAINI6AGFDj2OlIISAEhoiAGNAQAdThQkAINI6AGFDj2OlIISAEhoiAGNAQAdThQkAINI6AGFDj2OlIISAEhoiAGNAQAdThQkAINI6AGFDj2OlIISAEhoiAGNAQAdThQkAINI6AGFDj2OlIISAEhoiAGNA/OdY2AAAAWElEQVQQAdThQkAINI6AGFDj2OlIISAEhoiAGNAQAdThQkAINI6AGFDj2OlIISAEhoiAGNAQAdThQkAINI6AGFDj2OlIISAEhoiAGNAQAdThQkAINI7A/wEBQzeCaamYEQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>We can now define our model:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>GaussianLinear <span class="ot">&lt;-</span> <span class="fu">nn_module</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">initialize =</span> <span class="cf">function</span>() {</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># this linear predictor will estimate the mean of the normal distribution</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    self<span class="sc">$</span>linear <span class="ot">&lt;-</span> <span class="fu">nn_linear</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># this parameter will hold the estimate of the variability</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    self<span class="sc">$</span>scale <span class="ot">&lt;-</span> <span class="fu">nn_parameter</span>(<span class="fu">torch_ones</span>(<span class="dv">1</span>))</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">forward =</span> <span class="cf">function</span>(x) {</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># we estimate the mean</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    loc <span class="ot">&lt;-</span> self<span class="sc">$</span><span class="fu">linear</span>(x)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return a normal distribution</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distr_normal</span>(loc, self<span class="sc">$</span>scale)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">GaussianLinear</span>()</span></code></pre></div>
<p>We can now train our model with:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>opt <span class="ot">&lt;-</span> <span class="fu">optim_sgd</span>(model<span class="sc">$</span>parameters, <span class="at">lr =</span> <span class="fl">0.1</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  opt<span class="sc">$</span><span class="fu">zero_grad</span>()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">model</span>(x)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  loss <span class="ot">&lt;-</span> <span class="fu">torch_mean</span>(<span class="sc">-</span>d<span class="sc">$</span><span class="fu">log_prob</span>(y))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  loss<span class="sc">$</span><span class="fu">backward</span>()</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  opt<span class="sc">$</span><span class="fu">step</span>()</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">10</span> <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;iter: &quot;</span>, i, <span class="st">&quot; loss: &quot;</span>, loss<span class="sc">$</span><span class="fu">item</span>(), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter:  10  loss:  2.371322 </span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter:  20  loss:  2.198657 </span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter:  30  loss:  2.072692 </span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter:  40  loss:  1.953401 </span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter:  50  loss:  1.829014 </span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter:  60  loss:  1.697476 </span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter:  70  loss:  1.571049 </span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter:  80  loss:  1.483804 </span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter:  90  loss:  1.452302 </span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter:  100  loss:  1.445976</span></span></code></pre></div>
<p>We can see the parameter estimates with:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>model<span class="sc">$</span>parameters</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $linear.weight</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; torch_tensor</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2.0788</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [ CPUFloatType{1,1} ]</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $linear.bias</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; torch_tensor</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.0011</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [ CPUFloatType{1} ]</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $scale</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; torch_tensor</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.0323</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [ CPUFloatType{1} ]</span></span></code></pre></div>
<p>and quickly compare with the <code>glm()</code> function:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glm</span>(<span class="fu">as.numeric</span>(y) <span class="sc">~</span> <span class="fu">as.numeric</span>(x)))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; glm(formula = as.numeric(y) ~ as.numeric(x))</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2.8718  -0.5836  -0.0256   0.5039   3.2606  </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)     1.0333     0.1051    9.83 2.84e-16 ***</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; as.numeric(x)   2.1196     0.1028   20.61  &lt; 2e-16 ***</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 1.074217)</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 561.54  on 99  degrees of freedom</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 105.27  on 98  degrees of freedom</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC: 294.93</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
